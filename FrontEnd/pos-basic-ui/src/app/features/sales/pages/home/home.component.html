<div class="view-content">
  <div class="flex flex-col md:flex-row gap-4">
    <div class="w-full md:w-2/3 section">
      <h3 class="text-lg font-medium mb-3">Productos</h3>
      <div class="flex flex-col sm:flex-row gap-2 mb-4">
        <input
          type="search"
          placeholder="Buscar por nombre o SKU..."
          class="flex-grow p-2 border border-gray-300 rounded"
        />
        <div class="flex gap-1">
          <button
            class="bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-3 rounded text-sm"
          >
            Todas Cat.
          </button>
        </div>
      </div>

      <div
        class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3"
      >
        <div class="product-card" (click)="toggleProductDetailModal(true, product)" *ngFor="let product of productList">
          <div
            class="bg-gray-200 h-20 mb-2 rounded flex items-center justify-center text-gray-500"
          >
            [Imagen Prod.]
          </div>
          <p class="font-semibold text-sm">{{ product.name }}</p>
          <!-- <p class="text-xs text-gray-600"></p> -->
        </div>
      </div>
    </div>

    <div class="w-full md:w-1/3 section flex flex-col">
      <h3 class="text-lg font-medium mb-3">Transacción Actual</h3>
      <div class="flex-grow overflow-y-auto mb-4 border-b pb-2">
        <div class="transaction-item">
          <span>Camisa Polo (M, Azul) x 1</span>
          <span>$25.000</span>
        </div>
        <div class="transaction-item">
          <span>Pantalón Vaquero (32, Negro) x 1</span>
          <span>$80.000</span>
        </div>
        <div class="transaction-item">
          <span>Gorra Básica x 2</span>
          <span>$30.000</span>
        </div>
      </div>
      <div class="space-y-1 text-sm mb-4">
        <div class="flex justify-between">
          <span>Subtotal:</span><span>$135.000</span>
        </div>
        <div class="flex justify-between">
          <span>IVA (19%):</span><span>$25.650</span>
        </div>
        <div class="flex justify-between text-lg font-bold">
          <span>Total:</span><span>$160.650</span>
        </div>
        <div class="flex justify-between text-red-600 hidden">
          <span>Descuento:</span><span>-$16.065 (10%)</span>
        </div>
      </div>
      <div class="mt-auto space-y-2">
        <button
        (click)="toggleDiscountModal(true)"
          class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded text-sm"
        >
          Aplicar Descuento
        </button>
        <button
          (click)="togglePaymentModal(true)"
          class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded text-lg"
        >
          Pagar
        </button>
        <button
          class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded text-sm"
        >
          Anular Venta
        </button>
      </div>
    </div>
  </div>
</div>

<app-modal [(shown)]="showProductDetail" [title]="'Seleccionar Variante: '+selectedProduct?.name">

  <div class="mb-4" *ngFor="let option of currentVariantOptions | keyvalue">
    <label class="block text-sm font-medium text-gray-700 mb-1">
      {{ option.key }}:
    </label>
    <div class="flex gap-2">
      <button
        *ngFor="let value of option.value"
        class="border border-gray-300 py-1 px-3 rounded hover:bg-gray-100 focus:bg-blue-200 focus:outline-none"
      >
        {{ value.variantValue }} <span class="text-xs text-gray-500">(0)</span>
      </button>
    </div>
  </div>

  <div class="mb-6">
    <label
      for="qty-variante"
      class="block text-sm font-medium text-gray-700 mb-1"
      >Cantidad</label
    >
    <input
      type="number"
      id="qty-variante"
      value="1"
      min="1"
      class="w-20 p-2 border border-gray-300 rounded"
    />
  </div>
  <div class="mb-6" *ngIf="variantSelected">
    <label
      for="qty-variante"
      class="block text-sm font-medium text-gray-700 mb-1"
      >Precio:</label
    >
    <p>{{ variantSelected.price | currency }}</p>
  </div>
  <div class="flex justify-end gap-2">
    <button
      onclick="hideModal('modal-variantes')"
      class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"
    >
      Cancelar
    </button>
    <button
      onclick="hideModal('modal-variantes')"
      class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
    >
      Agregar
    </button>
  </div>
</app-modal>

<app-modal [(shown)]="showDiscount" title="Aplicar Descuento (Sobre Total)">
  <div class="flex gap-2 mb-4">
    <div class="flex-1">
      <label
        for="desc-porcentaje"
        class="block text-sm font-medium text-gray-700 mb-1"
        >Porcentaje (%):</label
      >
      <input
        type="number"
        id="desc-porcentaje"
        placeholder="Ej: 10"
        class="w-full p-2 border border-gray-300 rounded"
      />
    </div>
    <div class="flex-1">
      <label
        for="desc-monto"
        class="block text-sm font-medium text-gray-700 mb-1"
        >Monto Fijo ($):</label
      >
      <input
        type="number"
        id="desc-monto"
        placeholder="Ej: 5000"
        class="w-full p-2 border border-gray-300 rounded"
      />
    </div>
  </div>
  <div class="flex justify-end gap-2">
    <button
      (click)="toggleDiscountModal(false)"
      class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"
    >
      Cancelar
    </button>
    <button
      (click)="toggleDiscountModal(false)"
      class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded"
    >
      Aplicar
    </button>
  </div>
</app-modal>

<app-modal [(shown)]="showPayment" title="Procesar Pago">
  <p class="mb-4 text-xl font-bold">Total a Pagar: $160.650</p>
  <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-2"
      >Método de Pago:</label
    >
    <div class="flex gap-3">
      <button
        class="flex-1 border border-gray-300 py-2 px-4 rounded hover:bg-gray-100 focus:bg-blue-200 focus:outline-none"
      >
        Efectivo
      </button>
      <button
        class="flex-1 border border-gray-300 py-2 px-4 rounded hover:bg-gray-100 focus:bg-blue-200 focus:outline-none"
      >
        Tarjeta
      </button>
    </div>
  </div>
  <div class="mb-4">
    <label
      for="monto-recibido"
      class="block text-sm font-medium text-gray-700 mb-1"
      >Monto Recibido (Efectivo):</label
    >
    <input
      type="number"
      id="monto-recibido"
      placeholder="0.00"
      class="w-full p-2 border border-gray-300 rounded"
    />
  </div>
  <p class="mb-6 text-lg">Cambio: <span class="font-bold">$0.00</span></p>
  <div class="flex justify-end gap-2">
    <button
      onclick="hideModal('modal-pago')"
      class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"
    >
      Cancelar
    </button>
    <button
      onclick="hideModal('modal-pago')"
      class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
    >
      Finalizar Venta
    </button>
  </div>
</app-modal>
